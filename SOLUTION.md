# Решение

## Описание решения

Решила использовать денормализацию данных, потому что в задаче написано что операций чтения очень много, а обновлений мало, и БД - узкое место. 

### Структура данных

В `EmployeeData` храню не только UUID-ы для связанных сущностей (город, позиция, департамент), но и их названия (`cityName`, `positionName`, `divisionName`). Так при чтении не нужно делать дополнительные запросы - все данные уже есть в документе сотрудника.

Плюсы:
- Один запрос к БД вместо нескольких
- Не нужны join-ы
- Быстро работает

Минусы (но они не критичны, т.к. обновлений мало):
- При изменении города/позиции нужно будет обновлять все связанные записи сотрудников
- Данные дублируются, но это не проблема при редких обновлениях

### Организация кода

Разбила код на модули:
- `types.ts` - типы данных
- `repository.ts` - репозиторий для работы с БД
- `index.ts` - реализация интерфейса IHRApp

Так проще поддерживать и тестировать.

### Реализация методов

Оба метода (`employeeWithCityList` и `employeeWithPositionList`) работают одинаково:
1. Делают один запрос `query` для получения всех сотрудников
2. Преобразуют данные в нужный формат

Все данные уже денормализованы, так что просто маппинг полей.

### Предположения

1. Документы в БД имеют поле `type` в `data` для фильтрации
2. При сохранении сотрудника данные денормализуются (подтягиваются актуальные названия из связанных сущностей)
3. `query` с фильтром по `type` оптимизирован на уровне БД (индексы)

## Ответ на вопрос 3

Если бы было наоборот - мало чтений, много записей, то использовала бы нормализацию.

Структура была бы такой:
- `EmployeeData` содержал бы только UUID-ы (без `cityName`, `positionName`, `divisionName`)
- Города, позиции и департаменты хранились бы отдельно

Тогда:
- При чтении нужно было бы делать несколько запросов (сотрудники + города + позиции + департаменты) и собирать результат в памяти
- Зато при обновлении города/позиции/департамента менялся бы только один документ, без каскадных обновлений

Итого:
- Много чтений, мало записей → денормализация (как сейчас)
- Много записей, мало чтений → нормализация

Нужно оптимизировать под тот сценарий, который преобладает.
